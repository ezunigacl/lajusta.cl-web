<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Justa | Simulador de Pensión & Diagnóstico</title>
    
    <!-- Fuentes y Estilos -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@1&family=Inter:wght@300;400;500;600&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Animaciones y Configuración Tailwind -->
    <script>
        // Variables globales para indicadores financieros
        let currentUF = 37985.50; 
        const defaultUFValue = 37985.50;

        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ocean: '#022C43',       // Fondo principal
                        oceanLight: '#053B58',  // Paneles
                        oceanDark: '#011826',   // Footer/Inputs
                        acid: '#CCFF00',        // Acento principal
                        acidHover: '#b3e600',
                        lightText: '#E6F4F1',
                        blurOverlay: 'rgba(2, 44, 67, 0.85)'
                    },
                    fontFamily: {
                        serif: ['Instrument Serif', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                    },
                    keyframes: {
                        'fade-in-up': {
                            '0%': { opacity: '0', transform: 'translateY(20px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        'pulse-glow': {
                            '0%, 100%': { boxShadow: '0 0 10px rgba(204, 255, 0, 0.1)' },
                            '50%': { boxShadow: '0 0 25px rgba(204, 255, 0, 0.3)' },
                        }
                    },
                    animation: {
                        'fade-in-up': 'fade-in-up 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'pulse-glow': 'pulse-glow 3s infinite',
                    },
                }
            }
        }
    </script>

    <style>
        body { background-color: #022C43; color: #E6F4F1; overflow-x: hidden; }
        .font-serif { font-family: 'Instrument Serif', serif; font-style: italic; }
        .font-mono { font-family: 'Space Mono', monospace; }
        .text-glow { text-shadow: 0 0 20px rgba(204, 255, 0, 0.4); }
        
        /* Efecto Vidrio */
        .glass-panel { 
            background: rgba(5, 59, 88, 0.4); 
            backdrop-filter: blur(12px); 
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08); 
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        /* Fondo de Cuadrícula Sutil */
        .grid-bg { 
            background-image: 
                linear-gradient(rgba(204, 255, 0, 0.03) 1px, transparent 1px), 
                linear-gradient(90deg, rgba(204, 255, 0, 0.03) 1px, transparent 1px); 
            background-size: 40px 40px; 
            background-position: center top;
        }

        /* Inputs Personalizados */
        .input-premium {
            background: rgba(1, 24, 38, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
            font-family: 'Space Mono', monospace;
        }
        .input-premium:focus { 
            border-color: #CCFF00; 
            outline: none; 
            box-shadow: 0 0 15px rgba(204, 255, 0, 0.15); 
            background: rgba(1, 24, 38, 0.9);
        }
        
        /* Botones 3D */
        .btn-3d { transition: all 0.1s ease; box-shadow: 4px 4px 0px rgba(0,0,0,0.5); transform: translate(0,0); }
        .btn-3d:hover { transform: translate(-1px, -1px); box-shadow: 6px 6px 0px rgba(0,0,0,0.4); }
        .btn-3d:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px rgba(0,0,0,0.5); }

        /* Utilitarios de Bloqueo Inteligente */
        .data-blur { 
            color: transparent; 
            text-shadow: 0 0 8px rgba(204, 255, 0, 0.8); 
            user-select: none;
        }
        .locked-overlay-gradient {
            background: linear-gradient(to bottom, rgba(2, 44, 67, 0.1) 0%, rgba(2, 44, 67, 0.9) 40%, #022C43 100%);
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #022C43; }
        ::-webkit-scrollbar-thumb { background: #053B58; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #CCFF00; }
    </style>
</head>
<body class="grid-bg relative antialiased selection:bg-acid selection:text-ocean flex flex-col min-h-screen">

    <!-- Notificaciones Flotantes -->
    <div id="messageBox" class="fixed top-24 left-1/2 -translate-x-1/2 hidden z-[1100] transition-all duration-300 w-full max-w-sm px-4">
        <div class="p-4 rounded-xl shadow-2xl font-mono text-sm border flex items-center gap-3" id="messageBoxContent">
            <i id="msgIcon" data-lucide="info"></i>
            <p id="messageText" class="font-bold"></p>
        </div>
    </div>

    <!-- Navegación Estándar -->
    <nav class="fixed w-full z-50 glass-panel border-b-0 border-white/5 top-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center gap-6">
                    <a href="index.html" class="flex items-center gap-3 group flex-shrink-0">
                        <img src="Logo.jpg" alt="Logo" class="h-10 w-10 rounded-lg border border-white/10 group-hover:border-acid transition-colors object-cover">
                        <span class="font-serif text-2xl md:text-3xl text-acid tracking-wide">La Justa<span class="text-white">.</span></span>
                    </a>
                    <!-- INDICADORES MD+ -->
                    <div class="hidden md:flex items-center gap-4 bg-oceanLight/30 border border-white/10 px-4 py-1.5 rounded-lg backdrop-blur-md">
                        <div class="flex flex-col items-start leading-none border-r border-white/10 pr-4">
                            <span class="text-[9px] font-bold text-acid uppercase tracking-widest mb-0.5">UF HOY</span>
                            <span id="navUF" class="font-mono text-white text-xs font-bold animate-pulse">...</span>
                        </div>
                        <div class="flex flex-col items-start leading-none">
                            <span class="text-[9px] font-bold text-acid uppercase tracking-widest mb-0.5">UTM MES</span>
                            <span id="navUTM" class="font-mono text-white text-xs font-bold animate-pulse">...</span>
                        </div>
                    </div>
                </div>
                <div class="hidden lg:block">
                    <div class="ml-10 flex items-baseline space-x-8 font-mono text-sm">
                        <a href="index.html#inicio" class="text-white hover:text-acid transition-colors duration-300">INICIO</a>
                        <a href="index.html#que-hacemos" class="text-white hover:text-acid transition-colors duration-300">SERVICIOS</a>
                        <a href="index.html#tools" class="text-acid hover:text-white transition-colors duration-300 glow-sm">[ HERRAMIENTAS ]</a>
                        <a href="index.html#login" id="nav-login-desktop" class="border border-acid text-acid px-4 py-2 hover:bg-acid hover:text-ocean transition-all duration-300 btn-3d">ACCESO</a>
                    </div>
                </div>
                <div class="lg:hidden">
                    <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')" class="text-white hover:text-acid p-2 focus:outline-none">
                        <i data-lucide="menu" class="w-8 h-8"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- MENU MÓVIL -->
        <div id="mobile-menu" class="hidden lg:hidden bg-oceanDark/95 backdrop-blur-xl border-t border-white/10 absolute w-full left-0">
             <div class="px-4 py-4 border-b border-white/5 md:hidden">
                <div class="flex justify-between gap-4 bg-oceanLight/20 p-3 rounded-lg border border-white/5">
                    <div class="flex flex-col items-center flex-1 border-r border-white/10">
                        <span class="text-[9px] font-bold text-acid uppercase tracking-widest mb-0.5">UF HOY</span>
                        <span id="navUF-mobile" class="font-mono text-white text-xs font-bold">...</span>
                    </div>
                    <div class="flex flex-col items-center flex-1">
                        <span class="text-[9px] font-bold text-acid uppercase tracking-widest mb-0.5">UTM MES</span>
                        <span id="navUTM-mobile" class="font-mono text-white text-xs font-bold">...</span>
                    </div>
                </div>
            </div>
            <div class="px-4 pt-2 pb-6 space-y-2 font-mono text-sm">
                <a href="index.html#inicio" class="block px-3 py-4 text-white hover:text-acid border-b border-white/5">INICIO</a>
                <a href="simulador.html" class="block px-3 py-4 text-acid font-bold border-b border-white/5">SIMULADOR</a>
                <a href="index.html#login" id="nav-login-mobile" class="block px-3 py-4 text-acid hover:text-white border-b border-white/5">ACCESO</a>
            </div>
        </div>
    </nav>

    <div class="pt-28"></div>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 mb-20 flex-grow w-full">
        
        <div class="text-center mb-12 animate-fade-in-up">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-acid/10 border border-acid/20 mb-4">
                <span class="relative flex h-2 w-2">
                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-acid opacity-75"></span>
                  <span class="relative inline-flex rounded-full h-2 w-2 bg-acid"></span>
                </span>
                <span class="text-[10px] font-mono text-acid font-bold uppercase tracking-widest">Motor Actuarial 2.0</span>
            </div>
            <h1 class="font-serif text-5xl md:text-6xl text-white mb-4 leading-tight">Proyecta tu Futuro <br><span class="text-white/30">Sin Letra Chica.</span></h1>
            <p class="text-gray-400 max-w-xl mx-auto text-sm font-sans leading-relaxed">
                El simulador más preciso de Chile. Obtén un diagnóstico preliminar en segundos y agenda una sesión gratuita para recibir el informe detallado de estrategias de pensión.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12 items-start">
            
            <!-- COLUMNA IZQUIERDA: Formulario -->
            <div class="lg:col-span-5 space-y-6 animate-fade-in-up" style="animation-delay: 0.1s;">
                <div class="glass-panel rounded-2xl p-6 lg:p-8 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 p-4 opacity-10 pointer-events-none group-hover:opacity-20 transition-opacity">
                        <i data-lucide="calculator" class="w-24 h-24 text-white"></i>
                    </div>

                    <h2 class="text-2xl font-serif italic text-white mb-6 flex items-center gap-2">
                        <span class="w-6 h-6 rounded-full bg-acid text-ocean text-xs font-bold flex items-center justify-center font-mono not-italic">1</span>
                        Tus Datos
                    </h2>

                    <div class="space-y-5">
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] font-mono font-bold text-acid/80 uppercase tracking-widest mb-1 block">Nombre</label>
                                <input type="text" id="inputName" class="input-premium w-full rounded-lg px-3 py-3 text-sm" placeholder="Tu Nombre">
                            </div>
                            <div>
                                <label class="text-[10px] font-mono font-bold text-acid/80 uppercase tracking-widest mb-1 block">Apellido</label>
                                <input type="text" id="inputLastName" class="input-premium w-full rounded-lg px-3 py-3 text-sm" placeholder="Tu Apellido">
                            </div>
                        </div>

                        <div>
                            <label class="text-[10px] font-mono font-bold text-acid/80 uppercase tracking-widest mb-1 block">RUT</label>
                            <input type="text" id="inputRut" class="input-premium w-full rounded-lg px-3 py-3 text-sm font-mono" placeholder="12.345.678-9" maxlength="12">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] font-mono font-bold text-acid/80 uppercase tracking-widest mb-1 block">Email</label>
                                <input type="email" id="inputEmail" class="input-premium w-full rounded-lg px-3 py-3 text-xs" placeholder="correo@ejemplo.com">
                            </div>
                            <div>
                                <label class="text-[10px] font-mono font-bold text-acid/80 uppercase tracking-widest mb-1 block">Teléfono</label>
                                <input type="tel" id="inputPhone" class="input-premium w-full rounded-lg px-3 py-3 text-xs font-mono" placeholder="912345678">
                            </div>
                        </div>

                        <div class="border-t border-white/10 pt-4 mt-4">
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="text-[10px] font-mono font-bold text-white/50 uppercase tracking-widest mb-1 block">Fecha Nacimiento</label>
                                    <input type="date" id="inputDob" class="input-premium w-full rounded-lg px-2 py-2.5 text-xs text-center">
                                </div>
                                <div>
                                    <label class="text-[10px] font-mono font-bold text-white/50 uppercase tracking-widest mb-1 block">Género</label>
                                    <select id="inputGender" class="input-premium w-full rounded-lg px-2 py-2.5 text-xs text-center appearance-none cursor-pointer hover:bg-oceanDark">
                                        <option value="M">Masculino</option>
                                        <option value="F">Femenino</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="flex items-center justify-between bg-oceanDark/40 p-3 rounded-lg border border-white/5 mb-4">
                                <span class="text-[10px] font-mono font-bold text-white/70 uppercase">¿Tienes Cónyuge?</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="checkSpouse" class="sr-only peer">
                                    <div class="w-9 h-5 bg-oceanLight peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-acid"></div>
                                </label>
                            </div>
                            <div id="spouseDobContainer" class="hidden mb-4 animate-fade-in-up">
                                <label class="text-[9px] font-mono text-white/40 uppercase mb-1 block">Fecha Nacimiento Cónyuge</label>
                                <input type="date" id="inputSpouseDob" class="input-premium w-full rounded-lg px-2 py-2 text-xs">
                            </div>

                            <div class="bg-oceanLight/20 p-4 rounded-xl border border-white/5">
                                <label class="text-[10px] font-mono font-bold text-acid uppercase tracking-widest mb-2 block flex items-center gap-2">
                                    <i data-lucide="wallet" class="w-3 h-3"></i> Total Ahorrado (CLP)
                                </label>
                                <div class="relative">
                                    <span class="absolute left-3 top-3 text-white/30 font-mono text-sm">$</span>
                                    <input type="text" id="inputBalance" class="input-premium w-full rounded-lg pl-8 py-3 font-mono font-bold text-lg text-white currency-input" placeholder="0">
                                </div>
                                <p class="text-[9px] text-white/30 mt-2 font-mono leading-tight">Suma tu Saldo Obligatorio + Bono Reconocimiento + APV.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <button id="btnSimulate" onclick="runSimulation()" class="btn-3d w-full bg-acid text-ocean font-extrabold py-5 rounded-xl uppercase tracking-[0.2em] text-sm flex justify-center items-center gap-3 hover:bg-white hover:text-ocean transition-colors group relative overflow-hidden">
                    <span class="relative z-10">Generar Diagnóstico</span>
                    <i data-lucide="zap" class="w-5 h-5 relative z-10 group-hover:scale-110 transition-transform"></i>
                    <div class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></div>
                </button>
                
                <p class="text-[10px] text-center text-white/30 font-mono uppercase">Calculado con Tablas de Mortalidad Vigentes y normativa CMF.</p>
            </div>

            <!-- COLUMNA DERECHA: Resultados -->
            <div class="lg:col-span-7 h-full min-h-[500px]">
                
                <div id="placeholderState" class="h-full flex flex-col items-center justify-center glass-panel rounded-3xl p-12 text-center border-dashed border-white/10 animate-fade-in-up" style="animation-delay: 0.2s;">
                    <div class="w-24 h-24 bg-oceanDark rounded-full flex items-center justify-center mb-6 ring-1 ring-white/10">
                        <i data-lucide="bar-chart-3" class="w-10 h-10 text-white/20"></i>
                    </div>
                    <h3 class="text-2xl font-serif italic text-white mb-2">Esperando Datos...</h3>
                    <p class="text-gray-500 text-sm max-w-xs">Completa el formulario para visualizar tu proyección de pensión preliminar.</p>
                </div>

                <div id="resultsDashboard" class="hidden space-y-6 animate-fade-in-up">
                    
                    <!-- Tarjeta "Gratis" (Visible) -->
                    <div class="glass-panel rounded-2xl p-1 border-acid/30 relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-acid to-transparent opacity-50"></div>
                        <div class="bg-oceanDark/80 p-6 rounded-xl">
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                                <div>
                                    <span class="bg-acid/10 text-acid px-2 py-1 rounded text-[10px] font-bold uppercase tracking-widest border border-acid/20">Diagnóstico Preliminar</span>
                                    <h3 class="text-2xl font-serif italic text-white mt-2">Tu Panorama Hoy</h3>
                                </div>
                                <div class="text-right hidden md:block">
                                    <span class="text-[10px] text-white/40 block uppercase tracking-widest">Calculado en UF</span>
                                    <span class="text-sm font-mono text-white/60" id="resUfValue">...</span>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-oceanLight/30 rounded-lg p-5 border border-white/5">
                                    <div class="flex items-start justify-between mb-2">
                                        <span class="text-[10px] font-mono text-white/50 uppercase tracking-widest">Aporte Estatal (PGU)</span>
                                        <i data-lucide="help-circle" class="w-3 h-3 text-white/20"></i>
                                    </div>
                                    <div class="flex items-baseline gap-1">
                                        <span class="text-2xl font-mono font-bold text-white" id="resPgu">$0</span>
                                        <span class="text-[10px] text-white/30 font-mono">/ mes</span>
                                    </div>
                                    <div class="mt-2 h-1 w-full bg-oceanDark rounded-full overflow-hidden">
                                        <div id="pguBar" class="h-full bg-white/30 w-0 transition-all duration-1000"></div>
                                    </div>
                                </div>

                                <div class="bg-acid/5 rounded-lg p-5 border border-acid/20 relative overflow-hidden">
                                    <div class="absolute -right-2 -bottom-2 opacity-10">
                                        <i data-lucide="trending-up" class="w-16 h-16 text-acid"></i>
                                    </div>
                                    <div class="flex items-start justify-between mb-2">
                                        <span class="text-[10px] font-mono text-acid uppercase tracking-widest font-bold">Pensión Base Estimada</span>
                                    </div>
                                    <div class="flex items-baseline gap-1">
                                        <span class="text-3xl font-mono font-bold text-acid text-glow" id="resPensionBase">$0</span>
                                    </div>
                                    <p class="text-[10px] text-acid/60 mt-2 font-mono">Modalidad Retiro Programado (Año 1)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="glass-panel p-6 rounded-2xl border-white/5">
                        <h4 class="text-sm font-mono text-white/50 uppercase tracking-widest mb-4">Proyección de Flujo (Estimada)</h4>
                        <div class="h-[200px] w-full relative">
                            <canvas id="simpleChart"></canvas>
                        </div>
                    </div>

                    <!-- SECCIÓN BLOQUEADA (Lead Magnet - Enhanced) -->
                    <div class="relative rounded-3xl overflow-hidden mt-8 border border-white/10 group bg-oceanDark">
                        
                        <!-- Header del Informe Bloqueado -->
                        <div class="p-6 border-b border-white/5 bg-white/5 flex items-center justify-between">
                            <h3 class="font-serif italic text-xl text-white">Informe Actuarial Completo</h3>
                            <div class="flex items-center gap-2">
                                <span class="h-2 w-2 rounded-full bg-acid animate-pulse"></span>
                                <span class="text-[10px] font-mono text-white/60 uppercase">Calculado</span>
                            </div>
                        </div>

                        <!-- Contenido con Datos Simulados (Parte visible/borrosa) -->
                        <div class="p-8 relative">
                            <div class="space-y-6">
                                <!-- Bloque 1: Comparativa Base -->
                                <div>
                                    <h4 class="text-[10px] font-mono text-acid uppercase tracking-widest mb-3 border-b border-white/10 pb-1 w-full">Comparativa Modalidades</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white font-medium">Retiro Programado (AFP)</span>
                                            <span class="font-mono text-acid data-blur" id="lock-rp">Cargando...</span>
                                        </div>
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white font-medium">Renta Vitalicia Simple (Cía. Seguros)</span>
                                            <span class="font-mono text-acid data-blur" id="lock-rv-simple">Cargando...</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Bloque 2: Garantizados -->
                                <div>
                                    <h4 class="text-[10px] font-mono text-blue-400 uppercase tracking-widest mb-3 border-b border-white/10 pb-1 w-full">Periodos Garantizados (Protección Patrimonio)</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white/80">RV Garantizada 120 Meses (10 años)</span>
                                            <span class="font-mono text-blue-300 data-blur" id="lock-rv-120">Cargando...</span>
                                        </div>
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white/80">RV Garantizada 180 Meses (15 años)</span>
                                            <span class="font-mono text-blue-300 data-blur" id="lock-rv-180">Cargando...</span>
                                        </div>
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white/80">RV Garantizada 240 Meses (20 años)</span>
                                            <span class="font-mono text-blue-300 data-blur" id="lock-rv-240">Cargando...</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Bloque 3: Estrategias Avanzadas -->
                                <div>
                                    <h4 class="text-[10px] font-mono text-purple-400 uppercase tracking-widest mb-3 border-b border-white/10 pb-1 w-full">Estrategias de Renta Aumentada</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white/80">Renta Temporal Aumentada (12 Meses)</span>
                                            <div class="text-right">
                                                <span class="block font-mono text-purple-300 font-bold data-blur" id="lock-inc-12">Cargando...</span>
                                                <span class="text-[9px] text-white/30 uppercase">Doble Monto x 1 año</span>
                                            </div>
                                        </div>
                                        <div class="flex justify-between items-center text-sm">
                                            <span class="text-white/80">Renta Temporal Aumentada (24 Meses)</span>
                                            <div class="text-right">
                                                <span class="block font-mono text-purple-300 font-bold data-blur" id="lock-inc-24">Cargando...</span>
                                                <span class="text-[9px] text-white/30 uppercase">+50% Monto x 2 años</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Overlay de Bloqueo (Degradado + CTA) -->
                        <div class="absolute inset-0 locked-overlay-gradient flex flex-col items-center justify-end pb-12 z-20">
                            <div class="bg-oceanDark/90 backdrop-blur-md p-8 rounded-2xl border border-acid/20 text-center max-w-md mx-4 shadow-2xl">
                                <div class="w-12 h-12 bg-acid rounded-full flex items-center justify-center mx-auto mb-4 shadow-[0_0_20px_rgba(204,255,0,0.4)] animate-pulse">
                                    <i data-lucide="lock" class="w-6 h-6 text-ocean"></i>
                                </div>
                                
                                <h3 class="text-xl font-serif italic text-white mb-2">Resultados Listos para Revisión</h3>
                                <p class="text-gray-300 text-xs mb-6 font-sans leading-relaxed">
                                    Hemos calculado 7 escenarios optimizados para tu caso. Para ver los montos exactos y entender qué modalidad te conviene más, agenda una breve sesión de entrega de informe.
                                </p>

                                <button onclick="window.location.href='agenda-lajusta-web.html'" class="btn-3d w-full bg-white text-ocean px-6 py-4 rounded-xl font-bold font-mono text-xs uppercase tracking-widest hover:bg-acid transition-colors flex items-center justify-center gap-3 mb-3">
                                    <span>Agendar Asesoría Gratuita</span>
                                    <i data-lucide="calendar-check" class="w-4 h-4"></i>
                                </button>
                                
                                <p class="text-[9px] text-white/40 uppercase tracking-widest font-mono">100% Online • Sin Costo</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <footer class="bg-oceanDark pt-16 pb-8 border-t border-white/10 text-sm mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center md:text-left">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                <div class="col-span-1 md:col-span-2">
                    <div class="flex items-center gap-3 mb-4 justify-center md:justify-start">
                        <img src="Logo.jpg" alt="Logo" class="h-8 w-8 rounded-md border border-white/10 opacity-80 grayscale hover:grayscale-0 transition-all">
                        <span class="font-serif text-3xl text-white italic tracking-wide">La Justa.</span>
                    </div>
                    <p class="text-gray-500 max-w-sm font-sans">Reingeniería financiera para una nueva generación.</p>
                </div>
                <div><h4 class="font-mono text-acid text-xs uppercase mb-4 tracking-widest">Navegación</h4><ul class="space-y-2 font-mono text-gray-400"><li><a href="simulador.html" class="hover:text-white transition-colors">Simuladores</a></li><li><a href="#" class="hover:text-white transition-colors">Metodología</a></li></ul></div>
                <div><h4 class="font-mono text-acid text-xs uppercase mb-4 tracking-widest">Legal</h4><ul class="space-y-2 font-mono text-gray-400"><li><a href="#" class="hover:text-white transition-colors">Términos</a></li><li><a href="#" class="hover:text-white transition-colors">Privacidad</a></li></ul></div>
            </div>
            <div class="border-t border-white/5 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-gray-600 font-mono"><p>&copy; 2025 La Justa Fintech SpA. Todos los derechos reservados.</p><p class="mt-2 md:mt-0 max-w-lg">DISCLAIMER: Las proyecciones son referenciales.</p></div>
        </div>
    </footer>

    <!-- Lógica del Simulador -->
    <script>
        const PGU_MAX_AMOUNT = 214296; 
        const PGU_CUTOFF = 729000; 
        let currentUTM = 66000;
        let chartInstance = null;

        const formatCLP = (num) => new Intl.NumberFormat('es-CL', { style: 'currency', currency: 'CLP', maximumFractionDigits: 0 }).format(num);
        const formatUF = (num) => new Intl.NumberFormat('es-CL', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(num);
        const getVal = (id) => parseFloat(document.getElementById(id).value.replace(/\./g, '').replace(/\D/g, '')) || 0;

        async function fetchIndicators() {
            try {
                const res = await fetch('https://mindicador.cl/api');
                const data = await res.json();
                currentUF = data.uf.valor;
                currentUTM = data.utm.valor;
                
                document.getElementById('navUF').innerText = formatCLP(currentUF);
                document.getElementById('navUTM').innerText = formatCLP(currentUTM);
                
                const mobileUF = document.getElementById('navUF-mobile');
                const mobileUTM = document.getElementById('navUTM-mobile');
                if(mobileUF) mobileUF.innerText = formatCLP(currentUF);
                if(mobileUTM) mobileUTM.innerText = formatCLP(currentUTM);

                document.getElementById('resUfValue').innerText = `UF HOY: ${formatCLP(currentUF)}`;
            } catch (e) { 
                console.log('Usando valores default'); 
                document.getElementById('navUF').innerText = formatCLP(defaultUFValue);
                document.getElementById('navUTM').innerText = formatCLP(currentUTM);
            }
        }

        function calculateCNU(age, gender, hasSpouse) {
            const baseRate = 0.035; 
            const lifeExp = gender === 'M' ? 86 : 91;
            const years = Math.max(lifeExp - age, 5);
            let cnu = ((1 - Math.pow(1 + baseRate, -years)) / baseRate) * 12;
            if (hasSpouse) cnu *= 1.15; 
            return cnu;
        }

        function runSimulation() {
            const balance = getVal('inputBalance');
            const ageInput = document.getElementById('inputDob').value;
            
            if (!balance || !ageInput) {
                alert("Por favor ingresa tu fecha de nacimiento y el monto ahorrado.");
                return;
            }

            const age = new Date().getFullYear() - new Date(ageInput).getFullYear();
            const gender = document.getElementById('inputGender').value;
            const hasSpouse = document.getElementById('checkSpouse').checked;
            
            let pguEstimada = 0;
            if (age >= 65) {
                pguEstimada = PGU_MAX_AMOUNT;
                if (balance > 150000000) pguEstimada = 0; 
                else if (balance > 80000000) pguEstimada = PGU_MAX_AMOUNT * 0.6;
            }

            const cnu = calculateCNU(age, gender, hasSpouse);
            const pensionMensualCLP = Math.round(balance / cnu);
            
            // --- GENERACIÓN DE DATOS SIMULADOS PARA EL BLOQUEO ---
            // Factores de ajuste referenciales del mercado
            const baseVal = pensionMensualCLP;
            const rvSimple = baseVal * 0.92; // RV suele ser menor a RP inicial
            
            // Llenar el "Informe Bloqueado"
            document.getElementById('lock-rp').innerText = formatCLP(baseVal);
            document.getElementById('lock-rv-simple').innerText = formatCLP(rvSimple);
            
            document.getElementById('lock-rv-120').innerText = formatCLP(rvSimple * 0.97); // 10 años gar
            document.getElementById('lock-rv-180').innerText = formatCLP(rvSimple * 0.95); // 15 años gar
            document.getElementById('lock-rv-240').innerText = formatCLP(rvSimple * 0.92); // 20 años gar
            
            document.getElementById('lock-inc-12').innerText = formatCLP(rvSimple * 2.0); // Doble x 1 año
            document.getElementById('lock-inc-24').innerText = formatCLP(rvSimple * 1.5); // +50% x 2 años

            // UI Reveal
            document.getElementById('placeholderState').classList.add('hidden');
            document.getElementById('resultsDashboard').classList.remove('hidden');

            animateValue("resPgu", 0, pguEstimada, 1000);
            animateValue("resPensionBase", 0, pensionMensualCLP, 1500);
            
            const pguPercent = Math.min((pguEstimada / PGU_MAX_AMOUNT) * 100, 100);
            document.getElementById('pguBar').style.width = `${pguPercent}%`;

            renderChart(pensionMensualCLP, pguEstimada);
            document.getElementById('resultsDashboard').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const val = Math.floor(progress * (end - start) + start);
                obj.innerHTML = formatCLP(val);
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        function renderChart(base, pgu) {
            const ctx = document.getElementById('simpleChart').getContext('2d');
            if(chartInstance) chartInstance.destroy();

            const years = [2025, 2030, 2035, 2040, 2045];
            const dataRP = years.map((y, i) => base * Math.pow(0.96, i * 5)); 
            
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Proyección Tendencia',
                        data: dataRP,
                        borderColor: '#CCFF00',
                        backgroundColor: 'rgba(204, 255, 0, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointBackgroundColor: '#022C43',
                        pointBorderColor: '#CCFF00',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: { enabled: false } }, 
                    scales: {
                        x: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: 'rgba(255,255,255,0.4)', font: { family: 'Space Mono' } } },
                        y: { display: false } 
                    }
                }
            });
        }

        // Eliminada función openBooking() ya que se reemplazó por redirección directa en el botón

        document.getElementById('inputRut').addEventListener('input', (e) => {
            let val = e.target.value.replace(/[^0-9kK]/g, "");
            if(val.length > 1) {
                const c = val.slice(0, -1).replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                e.target.value = `${c}-${val.slice(-1).toUpperCase()}`;
            }
        });

        document.querySelectorAll('.currency-input').forEach(i => i.addEventListener('input', e => { 
            let v = e.target.value.replace(/\D/g, ""); 
            e.target.value = v ? parseInt(v).toLocaleString('es-CL') : ""; 
        }));

        document.getElementById('checkSpouse').addEventListener('change', e => {
            const container = document.getElementById('spouseDobContainer');
            if(e.target.checked) {
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            fetchIndicators();
            lucide.createIcons();
        });
    </script>

    <!-- FIREBASE AUTHENTICATION MODULE -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } 
        from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDdRWDUd-Ocmdqm3X0qMQBDU_O3yDBkGl4",
            authDomain: "lajusta-web.firebaseapp.com",
            projectId: "lajusta-web",
            storageBucket: "lajusta-web.firebasestorage.app",
            messagingSenderId: "231604835302",
            appId: "1:231604835302:web:70cdaee46afb20f9123c27",
            measurementId: "G-192LPZTRCR"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        window.loginWithGoogle = async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                const user = result.user;
                alert(`¡Bienvenido ${user.displayName}! Acceso concedido.`);
                updateUI(user);
            } catch (error) {
                console.error("Error en login:", error);
                alert("Hubo un error al iniciar sesión: " + error.message);
            }
        };

        window.logout = () => {
            signOut(auth).then(() => {
                alert("Sesión cerrada correctamente");
                updateUI(null);
            });
        };

        onAuthStateChanged(auth, (user) => {
            updateUI(user);
        });

        function updateUI(user) {
            const navLoginBtnDesktop = document.getElementById('nav-login-desktop'); 
            const navLoginBtnMobile = document.getElementById('nav-login-mobile'); 
            
            if (user) {
                if(navLoginBtnDesktop) {
                    navLoginBtnDesktop.innerText = "MI CUENTA";
                    navLoginBtnDesktop.classList.add('text-acid');
                    navLoginBtnDesktop.onclick = null; 
                }
                if(navLoginBtnMobile) {
                    navLoginBtnMobile.innerText = "MI CUENTA";
                    navLoginBtnMobile.classList.add('text-acid');
                }
            } else {
                if(navLoginBtnDesktop) {
                    navLoginBtnDesktop.innerText = "ACCESO";
                    navLoginBtnDesktop.classList.remove('text-acid');
                    navLoginBtnDesktop.onclick = (e) => { e.preventDefault(); window.loginWithGoogle(); };
                }
                if(navLoginBtnMobile) {
                    navLoginBtnMobile.innerText = "ACCESO";
                    navLoginBtnMobile.classList.remove('text-acid');
                    navLoginBtnMobile.onclick = (e) => { e.preventDefault(); window.loginWithGoogle(); };
                }
            }
        }
    </script>
</body>
</html>
